
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Rifa Bicis Monta√±a - Boletos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 20px; }
    h2 { text-align: center; color: #2E7D32; }
    .grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
    .boleto { background: #28a745; color: white; padding: 15px; width: 200px; border-radius: 8px; text-align: center; position: relative; }
    .numeros { font-size: 13px; margin-bottom: 10px; }
    .apartado { background: #ffc107 !important; color: #000 !important; }
    button { background: #fff; color: #28a745; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
    #modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); justify-content:center; align-items:center; z-index:999; }
    #modal-content { background:white; padding:20px; border-radius:10px; width:90%; max-width:400px; }
    input { width: 100%; margin-bottom: 10px; padding: 8px; }
    #temporizador { font-weight: bold; margin-top: 10px; }
    .leyenda { max-width: 700px; margin: 10px auto 30px auto; text-align: center; font-size: 14px; color: #444; background: #fff3cd; border: 1px solid #ffeeba; padding: 10px; border-radius: 8px; }
  </style>
</head>
<body>

<h2>üéüÔ∏è Selecciona tu n√∫mero de boleto</h2>

<div class="leyenda">
  üîí <strong>Tu nombre y tel√©fono NO ser√°n visibles p√∫blicamente.</strong><br>
  Solo el <strong>seud√≥nimo</strong> aparecer√° en el boleto si decides escribirlo. As√≠ podr√°s identificar cu√°les son tuyos cuando est√©n verificados como pagados ‚úÖ.
</div>

<div class="grid" id="grid-boletos"></div>

<!-- Modal de registro -->
<div id="modal">
  <div id="modal-content">
    <h3 id="titulo-boleto"></h3>
    <form id="formRegistro">
      <input type="hidden" id="boletoSeleccionado">
      <input type="text" id="nombre" placeholder="Nombre completo" required>
      <input type="tel" id="telefono" placeholder="Tel√©fono" required>
      <input type="text" id="seudonimo" placeholder="Seud√≥nimo (opcional)">
      <button type="submit">Confirmar apartado</button>
      <button type="button" onclick="cerrarModal()">Cancelar</button>
      <div id="temporizador"></div>
    </form>
  </div>
</div>

<script>
  const boletos = [
    { numero: "001", numeros: [910, 484, 552, 673, 421, 204, 832, 813, 825, 242] },
    { numero: "002", numeros: [105, 732, 328, 805, 294, 56, 212, 579, 239, 902] },
    { numero: "003", numeros: [501, 645, 442, 529, 879, 236, 307, 2, 668, 820] },
    { numero: "004", numeros: [517, 807, 47, 472, 664, 918, 674, 463, 816, 971] }
  ];

  const grid = document.getElementById("grid-boletos");
  boletos.forEach(b => {
    const div = document.createElement("div");
    div.className = "boleto";
    div.id = "boleto-" + b.numero;
    div.innerHTML = `
      <div><strong>BOLETO ${b.numero}</strong></div>
      <div class="numeros">${b.numeros.join(', ')}</div>
      <button onclick="abrirModal('${b.numero}')">üì• Apartar</button>
    `;
    grid.appendChild(div);
  });

  let tiempoRestante = 300;
  let temporizador;

  function abrirModal(num) {
    document.getElementById("boletoSeleccionado").value = num;
    document.getElementById("titulo-boleto").innerText = "Apartar BOLETO " + num;
    document.getElementById("modal").style.display = "flex";
    tiempoRestante = 300;
    actualizarTemporizador();
    temporizador = setInterval(() => {
      tiempoRestante--;
      actualizarTemporizador();
      if (tiempoRestante <= 0) {
        clearInterval(temporizador);
        alert("‚è∞ Tiempo agotado. El boleto fue liberado.");
        cerrarModal();
      }
    }, 1000);
  }

  function cerrarModal() {
    clearInterval(temporizador);
    document.getElementById("modal").style.display = "none";
  }

  function actualizarTemporizador() {
    const minutos = Math.floor(tiempoRestante / 60);
    const segundos = tiempoRestante % 60;
    document.getElementById("temporizador").innerText = `‚è≥ Tiempo restante: ${minutos}:${segundos < 10 ? '0' : ''}${segundos}`;
  }

  document.getElementById("formRegistro").addEventListener("submit", function(e) {
    e.preventDefault();
    clearInterval(temporizador);

    const folio = document.getElementById("boletoSeleccionado").value;
    const nombre = document.getElementById("nombre").value;
    const telefono = document.getElementById("telefono").value;
    const seudonimo = document.getElementById("seudonimo").value.trim();

    alert("‚úÖ Boleto " + folio + " apartado" + (seudonimo ? " por " + seudonimo : "") + ".");

    const div = document.getElementById("boleto-" + folio);
    div.classList.add("apartado");
    div.querySelector("button").innerText = seudonimo ? `‚úîÔ∏è ${seudonimo}` : "‚úîÔ∏è Apartado";
    div.querySelector("button").disabled = true;

    cerrarModal();

    // Env√≠a a Google Sheets (URL del Apps Script se agregar√° manualmente)
    fetch("AQUI_TU_URL_SCRIPT", {
      method: "POST",
      body: JSON.stringify({ folio, nombre, telefono, seudonimo }),
      headers: { "Content-Type": "application/json" }
    }).then(res => res.text()).then(resp => {
      console.log("Guardado en Sheets:", resp);
    });
  });
</script>

</body>
</html>
