<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generar Boletos Rifa</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getFirestore, collection, getDocs, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC-9BVF6sfbA1IcmawTtxFiwHOyHv0Qa3g",
      authDomain: "rifas-con-causa.firebaseapp.com",
      projectId: "rifas-con-causa",
      storageBucket: "rifas-con-causa.appspot.com",
      messagingSenderId: "347417635634",
      appId: "1:347417635634:web:3ddab8921d26707910452b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function generarBoletos() {
      const existingDocs = await getDocs(collection(db, "BoletosRifa"));
      if (!existingDocs.empty) {
        alert("⚠️ Ya existen boletos generados. Si deseas reiniciar, primero borra la colección.");
        return;
      }

      const numeros = Array.from({ length: 1000 }, (_, i) => i.toString().padStart(3, '0'));
      numeros.sort(() => Math.random() - 0.5);

      for (let i = 0; i < 100; i++) {
        const series = numeros.slice(i * 10, (i + 1) * 10);
        const boletoId = (i + 1).toString().padStart(3, '0');

        await setDoc(doc(db, "BoletosRifa", boletoId), {
          boleto: boletoId,
          estado: "libre",
          nombre: "",
          telefono: "",
          formaPago: "",
          modificadoPor: "",
          timestamp: new Date().toISOString(),
          series: series
        });

        console.log(`Boleto ${boletoId} generado con series: ${series.join(", ")}`);
      }

      alert("✅ Boletos 001 al 100 generados correctamente.");
    }

    document.addEventListener("DOMContentLoaded", generarBoletos);
  </script>
</head>
<body>
  <h1>Generar Boletos - Rifa Bicis Montaña</h1>
  <p>Este script generará los boletos 001 al 100 con series únicas si aún no existen.</p>
</body>
</html>
